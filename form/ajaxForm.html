<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="../jquery-1.10.1.js"></script>
    <style>
        .error {
            color: red;
            font-size: 12px
        }
        .avatardo {
            text-decoration: none;
            display: inline-block;
            /* line-height: 25px; */
            padding: 3px;
            border: 1px solid #ccc;
            color: #000000;
            /* border-radius: 3px; */
            background-color: #ccc;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <form action="form_post.php" method="POST" id="form">
        <table>
            <tr>
                <td>
                    <label for="username"> username </label>
                </td>
                <td>
                    <input type="text" name="username" class="username" id="username">
                </td>
            </tr>
            <tr>
                <td>
                    <label for="password"> password </label>
                </td>
                <td>
                    <input type="password" name="password" class="password" id="password">
                </td>
            </tr>
            <tr>
                <td>
                    <label for="avatar"> avatar </label>
                </td>
                <td>
                    <a href="#" class="avatardo">请选择头像</a>
                    <input type="file" name="avatar" class="avatar" id="avatar" style="display: none;">
                    <span class="avatar_name"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label for=""></label>
                </td>
                <td>
                    <button id="btnAjaxSubmit">ajaxSubmit提交</button>
                </td>
            </tr>
            <tr>
                <td>
                    <label for=""></label>
                </td>
                <td>
                    <input id="btnAjaxForm" type="submit" value="ajaxForm提交" />
                </td>
            </tr>
        </table>
    </form>

    <script src="../plug-in/form-4.2.2/src/jquery.form.js"></script>
    <script src="../plug-in/jquery-validation-1.17.0/dist/jquery.validate.js"></script>
    <script src="../plug-in/jquery-validation-1.17.0/dist/additional-methods.js"></script>
    <script src="../plug-in/jquery-validation-1.17.0/src/localization/messages_zh.js"></script>
    <script>
        $(document).ready(function () {
            $('.avatardo').click(function(e) {
                if (document.getElementById('avatar')) {
                    document.getElementById('avatar').click();
                }
                e.preventDefault();
            });
            $('#avatar').change(function() {
                console.log($('#avatar').prop('files'));
                $('.avatar_name').html($('#avatar').prop('files')[0].name)
            });
            // 验证
            $("form").validate({
                // debug: true, //调试模式，即使验证成功也不会跳转到目标页面
                rules: {     //配置验证规则，key就是被验证的dom对象，value就是调用验证的方法(也是json格式)
                    username: {
                        required: true,  //必填。如果验证方法不需要参数，则配置为true
                        rangelength: [6, 12]
                    },
                    password: {
                        required: true,
                        rangelength: [6, 12]
                    },
                    avatar: {
                        required: true
                    }
                },
                messages: {
                    username: {
                        required: '请输入用户名',
                    },
                    password: {
                        required: '请输入密码',
                    }
                }
            });

            // 表单上传
            var options = {
                success: function (data) {
                    // $("#responseText").text(data);
                    console.log(data);
                }
            };

            // ajaxForm
            $("#form").ajaxForm(options);

            // ajaxSubmit
            $("#btnAjaxSubmit").click(function () {
                $("#form").ajaxSubmit(options);
                return false;
            });
        });
    </script>
</body>
</html>